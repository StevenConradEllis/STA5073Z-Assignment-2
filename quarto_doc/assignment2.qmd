---
author:
  - name: Ropafadzo Chimuti
    email: CHMROP002@myuct.ac.za
  - name: Tanweer Nujjoo
    email: NJJSYE001@myuct.ac.za
  - name: Steven Ellis
    email: ELLSTE005@uct.ac.za
        
title: A Descriptive Analysis of the South African Presidential State of the Nation Address (SONA) - 1994 to 2023
keywords: SONA, text modelling, sentiment analysis, latent Dirichlet allocation, LDA, bag-of-words
abstract: |
 The annual State of the Nation Address (SONA) in South Africa serves as a critical national update by the President, delivered to Parliament. This research examines SONA  speeches from 1994 to 2023, accessed from the official government website.The study aims to conduct sentiment analysis and topic modeling on these speeches, utilizing analytical skills such as data cleaning, sentiment analysis, Latent Dirichlet Allocation (LDA) for topic extraction, and trend identification.This paper provides insights into how sentiments and key topics have evolved over time, offering a         comprehensive view of South Africa's political and societal landscape from 1994 to 2023. {The following findings were discovered}

bibliography: bibliography_Tanweer.bib
format:
   pdf: 
       toc: true
       number-sections: true
       extra_dependencies: ["float"]
       header-includes:
            - \usepackage{hyperref}
            - \usepackage{graphicx}
            - \usepackage[labelfont=bf]{caption}
            - \captionsetup[table]{font=scriptsize}
            - \captionsetup[figure]{font=scriptsize}
            - \usepackage{vmargin}  # Adjust the margin width here
            - \setmarginsrb{2 cm}{0.5 cm}{2 cm}{1 cm}{1 cm}{1 cm}{1 cm}{1 cm}
       fig-pos: 'H'
       fig-format: pdf
editor: source
---

```{r libraries, message=FALSE, warning=FALSE, results='hide', echo=FALSE}
library(stringr)
library(tidyverse)
library(tidytext)
library(textstem)
library(textdata)
library(tm)
library(MASS)
library(topicmodels)
library(knitr)
```

```{r extract, message=FALSE, warning=FALSE, results='hide', echo=FALSE}
set.seed(2023)

# Set working folder to parent folder
WD <- getwd()
if (!is.null(WD)) setwd(WD)
setwd('../') 

# read in text data files and organise these into a data frame
filenames <- c('1994_post_elections_Mandela.txt', 
               '1994_pre_elections_deKlerk.txt', 
               '1995_Mandela.txt', 
               '1996_Mandela.txt', 
               '1997_Mandela.txt',
               '1998_Mandela.txt', 
               '1999_post_elections_Mandela.txt', 
               '1999_pre_elections_Mandela.txt', 
               '2000_Mbeki.txt', 
               '2001_Mbeki.txt', 
               '2002_Mbeki.txt', 
               '2003_Mbeki.txt', 
               '2004_post_elections_Mbeki.txt', 
               '2004_pre_elections_Mbeki.txt', 
               '2005_Mbeki.txt', 
               '2006_Mbeki.txt', 
               '2007_Mbeki.txt', 
               '2008_Mbeki.txt', 
               '2009_post_elections_Zuma.txt', 
               '2009_pre_elections_ Motlanthe.txt', 
               '2010_Zuma.txt', 
               '2011_Zuma.txt', 
               '2012_Zuma.txt', 
               '2013_Zuma.txt', 
               '2014_post_elections_Zuma.txt', 
               '2014_pre_elections_Zuma.txt', 
               '2015_Zuma.txt', 
               '2016_Zuma.txt', 
               '2017_Zuma.txt', 
               '2018_Ramaphosa.txt', 
               '2019_post_elections_Ramaphosa.txt', 
               '2019_pre_elections_Ramaphosa.txt', 
               '2020_Ramaphosa.txt', 
               '2021_Ramaphosa.txt', 
               '2022_Ramaphosa.txt', 
               '2023_Ramaphosa.txt')

this_speech <- c()
this_speech[1] <- readChar('./sona-addresses-1994-2023/1994_post_elections_Mandela.txt', nchars = 27050)
this_speech[2] <- readChar('./sona-addresses-1994-2023/1994_pre_elections_deKlerk.txt', nchars = 12786)
this_speech[3] <- readChar('./sona-addresses-1994-2023/1995_Mandela.txt', nchars = 39019)
this_speech[4] <- readChar('./sona-addresses-1994-2023/1996_Mandela.txt', nchars = 39524)
this_speech[5] <- readChar('./sona-addresses-1994-2023/1997_Mandela.txt', nchars = 37489)
this_speech[6] <- readChar('./sona-addresses-1994-2023/1998_Mandela.txt', nchars = 45247)
this_speech[7] <- readChar('./sona-addresses-1994-2023/1999_post_elections_Mandela.txt', nchars = 34674)
this_speech[8] <- readChar('./sona-addresses-1994-2023/1999_pre_elections_Mandela.txt', nchars = 41225)
this_speech[9] <- readChar('./sona-addresses-1994-2023/2000_Mbeki.txt', nchars = 37552)
this_speech[10] <- readChar('./sona-addresses-1994-2023/2001_Mbeki.txt', nchars = 41719)
this_speech[11] <- readChar('./sona-addresses-1994-2023/2002_Mbeki.txt', nchars = 50544)
this_speech[12] <- readChar('./sona-addresses-1994-2023/2003_Mbeki.txt', nchars = 58284)
this_speech[13] <- readChar('./sona-addresses-1994-2023/2004_post_elections_Mbeki.txt', nchars = 34590)
this_speech[14] <- readChar('./sona-addresses-1994-2023/2004_pre_elections_Mbeki.txt', nchars = 39232)
this_speech[15] <- readChar('./sona-addresses-1994-2023/2005_Mbeki.txt', nchars = 54635)
this_speech[16] <- readChar('./sona-addresses-1994-2023/2006_Mbeki.txt', nchars = 48643)
this_speech[17] <- readChar('./sona-addresses-1994-2023/2007_Mbeki.txt', nchars = 48641)
this_speech[18] <- readChar('./sona-addresses-1994-2023/2008_Mbeki.txt', nchars = 44907)
this_speech[19] <- readChar('./sona-addresses-1994-2023/2009_post_elections_Zuma.txt', nchars = 31101)
this_speech[20] <- readChar('./sona-addresses-1994-2023/2009_pre_elections_Motlanthe.txt', nchars = 47157)
this_speech[21] <- readChar('./sona-addresses-1994-2023/2010_Zuma.txt', nchars = 26384)
this_speech[22] <- readChar('./sona-addresses-1994-2023/2011_Zuma.txt', nchars = 33281)
this_speech[23] <- readChar('./sona-addresses-1994-2023/2012_Zuma.txt', nchars = 33376)
this_speech[24] <- readChar('./sona-addresses-1994-2023/2013_Zuma.txt', nchars = 36006)
this_speech[25] <- readChar('./sona-addresses-1994-2023/2014_post_elections_Zuma.txt', nchars = 29403)
this_speech[26] <- readChar('./sona-addresses-1994-2023/2014_pre_elections_Zuma.txt', nchars = 36233)
this_speech[27] <- readChar('./sona-addresses-1994-2023/2015_Zuma.txt', nchars = 32860)
this_speech[28] <- readChar('./sona-addresses-1994-2023/2016_Zuma.txt', nchars = 32464)
this_speech[29] <- readChar('./sona-addresses-1994-2023/2017_Zuma.txt', nchars = 35981)
this_speech[30] <- readChar('./sona-addresses-1994-2023/2018_Ramaphosa.txt', nchars = 33290)
this_speech[31] <- readChar('./sona-addresses-1994-2023/2019_post_elections_Ramaphosa.txt', nchars = 42112)
this_speech[32] <- readChar('./sona-addresses-1994-2023/2019_pre_elections_Ramaphosa.txt', nchars = 56960)
this_speech[33] <- readChar('./sona-addresses-1994-2023/2020_Ramaphosa.txt', nchars = 47910)
this_speech[34] <- readChar('./sona-addresses-1994-2023/2021_Ramaphosa.txt', nchars = 43352)
this_speech[35] <- readChar('./sona-addresses-1994-2023/2022_Ramaphosa.txt', nchars = 52972)
this_speech[36] <- readChar('./sona-addresses-1994-2023/2023_Ramaphosa.txt', nchars = 53933)

sona <- data.frame(filename = filenames, speech = this_speech, stringsAsFactors = FALSE)
sona$speech_year <- str_sub(sona$filename, start = 1, end = 4)
sona$pres <- str_remove_all(str_extract(sona$filename, "[dA-Z].*\\."), "\\.")

# clean the sona dataset by adding the date and removing unnecessary text
replace_reg <- '(http.*?(\\s|.$))|(www.*?(\\s|.$))|&amp;|&lt;|&gt;|\n'

sona <-sona %>%
  mutate(speech = lemmatize_strings(stringr::str_replace_all(speech, replace_reg , ' '))
         ,date = str_sub(speech, start=1, end=30)
         ,date = str_replace_all(date, "February", "02")
         ,date = str_replace_all(date, "June", "06")
         ,date = str_replace_all(date, "Feb", "02")
         ,date = str_replace_all(date, "May", "05")
         ,date = str_replace_all(date, "Jun", "06")
         ,date = str_replace_all(date, "Thursday, ","")
         ,date = str_replace_all(date, ' ', '-')        
         ,date = str_replace_all(date, "[A-z]",'')
         ,date = str_replace_all(date, '-----', '')
         ,date = str_replace_all(date, '----', '')
         ,date = str_replace_all(date, '---', '')
         ,date = str_replace_all(date, '--', '')
  )

# Convert to tibble
sona <- as.tibble(sona)

```
\newpage 
# Introduction

The State of the Nation Address (SONA) is a crucial annual event in the political landscape of South Africa. It serves as a comprehensive summary of the nation's current status and a roadmap for its future. The address, delivered by the country's highest-ranking official, outlines achievements, priorities, and strategies for the upcoming year, significantly influencing policy, legislation, and public discourse.

This research paper, undertakes a comprehensive descriptive examination of the content within South African State of the Nation Addresses (SONAs), employing advanced techniques in sentiment analysis and topic modeling. Sentiment analysis allows for the extraction and quantification of emotional and attitudinal tones within the speeches, providing deeper insights into the language used by leaders to engage, motivate, and influence their audience. Understanding prevailing sentiments also offers valuable context for assessing the reception and impact of the SONA.

Furthermore, topic modeling enables the categorization of the diverse subjects addressed within these speeches. This approach clarifies the key areas of government focus and the shifting priorities as they evolve over time. It not only aids in identifying primary trends but also provides a quantitative basis for comparisons between different presidencies.

A comprehensive explanation of sentiment analysis and topic modeling, including a breakdown of their methodologies and an examination of the results as applied to the analysis of South African SONAs, are presented in relevant sections within this report.

# Materials and Methods

This section describes thoroughly the procedures undertaken to conduct a descriptive analysis of the content of speeches using sentiment analysis and topic modelling. The entire implementation of this task was performed using RStudio, therefore the functions and libraries used throughout the process corresponds to R. However, the equivalence of this analysis can definitely be replicated on other programming platforms. There are various ways to wrangle data and only the "not so obvious" functions were explained in this report. It should be further noted that all the plots produced in this report were generated via the `ggplot()` function from the `ggplot2` library.

## Brief Overview of SONA dataset

The dataset used in this study comprised of speeches obtained from various text files, each of differing sizes. These speeches were presented in a semi-formal structure, with a common characteristic being the inclusion of the date of delivery at the beginning. The data was not inherently structured in a manner conducive to automated tabulation and analysis. Therefore, preprocessing steps were necessary to facilitate subsequent analysis. Detailed information regarding the preprocessing procedures is provided in the following section.

## Data Pre-processing & Cleaning

Raw data retrieval tends to always be messy based on the overview given about the SONA dataset in the previous section. So, tabulating the text files needed some pre-processing where the years at which the speeches occurred were extracted by identifying the first 4 strings from the filenames and attributed them to a new column. Additionally, the names of the presidents were extracted from the filenames. Within the process of extracting the presidents' names, string manipulation was performed to remove unnecessary regular expressions. Although, the dates were not specifically used in our analysis, they were parsed in a new column for our own perusal. All the unnecessary regular expressions like "`(http.*?(...`" from the speeches were also removed. All those manipulations were done using the `stringr` library. Now that we were only dealing with words, we had to make sure that all the speeches were converted to lower cases and lemmatised to avoid any redundancies. The function used to perform the lemmatisation task, was `lemmatize_strings()` from the `textstem` library. Finally, the data was converted into a tibble.

## Central Preliminary Procedure 1 {#sec-PreliminaryProcedure1}

As an initial step prior to any analyses in the whole methodology section, if the tokenisation (refer to @sec-OverallAnalysis for an explanation on the concept of tokenisation) involved:

```{=tex}
\begin{enumerate}
  \item  words, only the lowercase words would first be detected using the matching pattern \textbf{[a-z]} and filtered. Then, the stop words (i.e, prepositions and connecting words) from the SMART lexicon of the \textbf{tidytext}  library would be removed as they do not convey valid information. In addition, some common and obvious words across all the speeches like "speaker", "madame", "honourable", "chairperson", "development", "national", "ensure", "deputy", "africa", "african", "africans", "south", "southern", "government", "people", "programme", "economic", "economy", "country" and "continue" which would act like noise in our analyses would be filtered out.
  
  \item  bigrams, each word would be separated into 2 different columns and then step 1 would be repeated for each column. Then the cleaned separated words would be united back in one column.
  
  \item  trigrams, each word would be separated into 3 different columns and then step 1 would be repeated for each column. Then the cleaned separated words would be united back in one column.
\end{enumerate}
```
## Overall Analysis {#sec-OverallAnalysis}

For any upcoming analyses, the speeches had to be tokenised accordingly to fit the purpose of our analyses. Tokenisation is the split of a sequence of characters in a text by locating the word boundaries [@palmer2000tokenisation]. The atomicity of the split could be in terms of per characters, per words, per n-grams, per sentences and more. So, tokenisation is always application dependent. For our purpose, tokenising per words and per n-grams were relevant. This was simply done using the `unnest_tokens()` function from the `tidytext` library. n-gram is a terminology very well known in the world of natural language processing (NLP), and it simply refers to a sequence of n words. If n=1, it is referred to as a unigram, if n=2, it is referred to as a bigram and if n=3, it is referred to as a trigram. The overall analysis sought to reveal the top 20 words, bigrams and trigrams used by all presidents. The steps to achieve these, followed the main procedures highlighted in @sec-PreliminaryProcedure1. Then for each case, the words, bigrams and trigrams were counted, sorted in descending order and sliced to the first 20 elements. Furthermore, they were all plotted as barplots.

A more in-depth overall analysis was performed by aggregating the above per president. However, only the overall trigrams used per presidents were analysed. The words and bigrams ones were omitted as the idea was, if we were to use more than a word anyways to do more in-depth analysis, we might as well use the trigrams as those would convey more meaningful information. So, the exact methods explained in the above paragraph were implemented with the exception that the presidents were first filtered in that same procedural pipeline.

## Central Preliminary Procedure 2 {#sec-PreliminaryProcedure2}

This procedure is sentiment-focused rather than use for an overall analysis purpose. Nevertheless, it follows similar steps as in @sec-PreliminaryProcedure1 with slight updates. Note that the words and bigrams part were omitted here based on the aforementioned argument in @sec-OverallAnalysis. As usual, an initial step prior to any sentiment analyses, if the tokenisation involved:

```{=tex}
\begin{enumerate}
  \item  words, only the lowercase words would first be detected using the matching pattern \textbf{[a-z]} and filtered. Then, the stop words (i.e, prepositions and connecting words) from the SMART lexicon of the \textbf{tidytext} library would be removed as they do not convey valid information. The same common and obvious words across all the speeches as detailed in Section \ref{sec-PreliminaryProcedure1} would act like noise in our analyses, hence would be filtered out. The relevant dictionary (further description about dictionaries is detailed in Section \ref{sec-SentimentAnalysisMethodology}) would be left joined to the cleaned dataset on the words so that the words in the speeches would have a sentiment attached to it. Obviously, not all the words in the speeches would be present in the dictionaries. Therefore, words that did not have a label would be mutated to "neutral".

  \item  trigrams, each word would be separated into 3 different columns and then step 1 would be repeated for each column. Then the cleaned separated words would be united back in one column. Because we would deal with trigrams, the sentiments would have to be polarised (i.e, "positive" = 1, "neutral" = 0 and "negative" = -1) in order to be able to calculate a final sentiment score for all the trio of words. That would be based on the sum of all polarised sentiment belonging to each trio of words. Moreover, if the final sentiment score = 0, the trigrams would remain as "neutral". If the final sentiment score $\geq$ 1, the trigrams would be "positive" and if the final sentiment score < 1, the trigrams would be "negative".
\end{enumerate}
```
## Sentiment Analysis {#sec-SentimentAnalysisMethodology}

According to @medhat2014sentiment, sentiment analysis also known as the opinion mining study people's opinions, attitudes, and emotions towards an entity in a computational manner and can also be considered as a classification process. Our sentiment analysis took a lexicon dictionary-based approach which is considered as a very feasible approach as it does not involve any training data and advanced machine learning techniques [@wankhade2022survey]. For this reason, some experts like @yan2010integrating also referred to this approach as an unsupervised approach. The 2 main dictionaries used in our analyses were `bing` and `nrc`.

The `bing` dictionary was loaded from the `tidytext` library. Each of the 6786 words in the dictionary is assigned to a binary sentiment of either positive or negative. The main disadvantage of the lexicon approach is that it is highly domain-oriented. Indeed, during some analysis, words like "anti poverty", "anti corruption", and so on were classified as negative sentiment as the word "anti" did not exist in the `bing` dictionary. Therefore, this issue was resolved by adding the word "anti" in the `bing` dictionary and assigned a positive sentiment to it as this label fits the context of this analysis. This part of the sentiment analysis explored the top 20 positive and negative trigrams used by all presidents. The steps to achieve these, followed the main procedures highlighted in @sec-PreliminaryProcedure2. Then for each case, the trigrams were filtered by either "positive" or "negative" sentiment, followed by a count and a sort in descending order and eventually sliced to the first 20 elements. Furthermore, they were all plotted as barplots.

A more in-depth sentiment analysis was performed by aggregating the above per president. The exact methods explained in the above paragraph were implemented with the exception that the presidents were first filtered in that same procedural pipeline. It was also vital to investigate the variation of positive and negative sentiments over the years while excluding deKlerk and Motlanthe as they were only 1-term presidents. Those investigations were done for the trigrams by following the procedure as described in @sec-PreliminaryProcedure2 and then plotted as barplots and line graphs. The only key aspect here was to group the sentiment and year before counting how many positive and negative sentiments were recorded per year.

This report also employed the **NRC Emotion Lexicon** for sentimental analysis, a resource that associates English words with eight fundamental emotions (anger, fear, anticipation, trust, surprise, sadness, joy, and disgust), along with two sentiments (negative and positive). This lexicon was used to analyse the emotions expressed in presidential speeches, providing insights into the emotional aspects of their leadership and communication.

```{r nrc-cleaning, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

replace_reg <- '(http.*?(\\s|.$))|(www.*?(\\s|.$))|&amp;|&lt;|&gt;'
unnest_reg <- "[^\\w_#@'’]"

# tidy text 
nrc_tidy_sona <- sona %>% 
  mutate(speech = str_replace_all(speech, replace_reg, '')) %>% # remove links etx
  unnest_tokens(word, speech, token = 'regex', pattern = unnest_reg) %>%   # tokenize
  filter(!word %in% stop_words$word, str_detect(word, '[A-Za-z]')) %>%  # remove stop words
  dplyr::select(word, pres, date, filename, speech_year)  # select variables needed

# Count the number of times each word in our vocabulary was used by each president, 
# creating a "long" (and tidy) format of the document-term matrix.
nrc_sona_tdf <- nrc_tidy_sona %>%
  group_by(pres,speech_year,word,date) %>%
  count() %>%  
  ungroup()

# Remove common SONA words that are used very regularly, but which don't convey too much meaning
common_sona_reg <- 'speaker|madame|honourable|chairperson|development|national|ensure|deputy|africa|african|africans|south|southern|government|people|programme|economic|economy|country'
nrc_sona_tdf <- nrc_sona_tdf %>% filter(!grepl(common_sona_reg, word))


```

```{r Main data cleaning, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# Set speech to lower case + lemmatize
sona_sentiment <- sona %>%
  mutate(speech = lemmatize_strings(tolower(speech)))
 
sona_sentiment <- as_tibble(sona_sentiment) # convert dataframe to tibble
sona_sentiment <- sona_sentiment[,-1] # removing first column
unnest_reg <- "[^\\w_#@']"

# Remove common SONA words that are used very regularly, but which don't convey too much meaning
common_sona_reg <- 'speaker|madame|honourable|chairperson|development|national|ensure|deputy|africa|african|africans|south|southern|government|people|programme|economic|economy|country|continue'
```

```{r Sentiment dictionaries, message=FALSE, warning=FALSE, results='hide', echo=FALSE}
# import sentiment dictionaries

bing <- get_sentiments('bing') 
#unique(bing$sentiment)

nrc <- get_sentiments('nrc') 
#unique(nrc$sentiment)

save(bing, nrc, file = "dsfi-lexicons.Rdata")
```

## Topic Modelling

Topic modelling is a machine learning technique that scans tokens (usually words) in sequences (usually documents), with the aim of detecting word and phrase patterns within the sequences. This is achieved by clustering word groups and similar expressions together into 'topics' that best characterize a set of documents. [@Pascual2019]

Topic models can help offer insights into bodies of text, for better understanding of large collections of unstructured text bodies. [@Blei2012]

In this assignment topic modelling was performed as follows:

A data-set of words that appeared in the corpus of presidential speeches was extracted into a **document-term matrix**, containing rows corresponding to the speeches and columns corresponding to the words.

The **Latent Dirichlet allocation (LDA)** method was then used to extract topics from this sparse and wide document-term matrix. The LDA algorithm is guided by two principles:

-   Every document is a mixture of *topics* (for example 90% topic A and 10% topic B) and every topic is a mixture of *words*.
-   Every topic is a probability distribution over words.

LDA draws topic distributions from a Dirichlet distribution and uses variational expectation maximisation algorithm, and collapsed Gibbs sampling (both beyond the scope of this assignment) to achieve topic model estimations.

The **LDA()** function from the `topicmodels` package was used to retrieve LDA topic models.

Latent Dirichlet allocation Topic modelling was performed in the following way:

-   The top 5 topics were retrieved across all speeches (to retrieve president-specific topics).
-   The `tidytext` package was then used to extract **per-topic-per-word probabilities** (the "beta") from the model.
-   The **per-president-per-topic probabilities** (the "gamma") were then extracted using the `tidytext` package.
-   The log ratio of beta values of topics for different presidents were compared to reveal words with the greatest differences between the two presidents' topics.
-   Finally, the speeches of Ramaphosa were retrieved, and the same exercise was repeated for Ramaphosa-specific speeches (to gain insights into the topics that permeated his speeches over the years).

```{r lda_all, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

replace_reg <- '(http.*?(\\s|.$))|(www.*?(\\s|.$))|&amp;|&lt;|&gt;'
unnest_reg <- "[^\\w_#@'’]"

# turn into tidy text 
tidy_sona <- sona %>% 
  mutate(speech = str_replace_all(speech, replace_reg, '')) %>% # remove links etx
  unnest_tokens(word, speech, token = 'regex', pattern = unnest_reg) %>%   # tokenize
  filter(!word %in% stop_words$word, str_detect(word, '[A-Za-z]')) %>%  # remove stop words
  dplyr::select(word, pres, date, filename)  # select variables needed

# Count the number of times each word in our vocabulary was used by each president, 
# creating a "long" (and tidy) format of the document-term matrix.
sona_tdf <- tidy_sona %>%
  group_by(pres,word) %>%
  count() %>%  
  ungroup()

# Remove common SONA words that are used very regularly, but which don't convey too much meaning
common_sona_reg <- 'speaker|madame|honourable|chairperson|development|national|ensure|deputy|africa|african|africans|south|southern|government|people|programme|economic|economy|country'
sona_tdf <- sona_tdf %>% filter(!grepl(common_sona_reg, word))

# Create a DocumentTermMatrix object using cast_dtm(), required by the topicmodels package 
# which we will use to implement the LDA topic model
dtm_sona <- sona_tdf %>% cast_dtm(pres, word, n)

# Estimate the parameters of the topic model using LDA
sona_lda <- LDA(dtm_sona, k = 5, control = list(seed = 2023))

# Use the tidy() function by the  tidytext package 
# for extracting the per-topic-per-word probabilities, called β (“beta”), from the model
sona_topics <- tidy(sona_lda, matrix = "beta")

# The model is now in one-topic-per-term-per-row format. 
# For each combination, the model computes the probability of that term 
# being generated from that topic. 

# Use dplyr’s slice_max() to find the 10 terms that are most common within each topic
sona_top_terms <- sona_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 20) %>% 
  ungroup() %>%
  arrange(topic, -beta)

```

# Results & Discussions

## Overall Analysis

```{r Top 20 words/bigrams/trigrams used by all presidents, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# OVERALL COMMON WORDS ANALYSIS -------------------------------------------
#  Most common words used by all presidents -------------------------------
overall_common_words <- sona_sentiment %>% 
  unnest_tokens(word, speech, token = 'regex', pattern = unnest_reg) %>%
  filter(str_detect(word, '[a-z]')) %>% 
  filter(!word %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word)) %>%
  count(word, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(word, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 words used by all presidents") +
  theme(plot.title = element_text(size = 7), 
        axis.title.x = element_text(size = 7), 
        axis.title.y = element_text(size = 7),
        axis.text.x = element_text(size = 7),
        axis.text.y = element_text(size = 7),
        legend.position = '')+
  scale_fill_gradient(low = "black", high = "grey")



# Most common bigram used by all presidents -------------------------------
overall_common_bigram <- sona_sentiment %>% 
  unnest_tokens(bigram, speech, token = 'ngrams', n=2) %>%
  separate(bigram, c('word1', 'word2'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  unite(bigram, word1, word2, sep = ' ') %>%
  count(bigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(bigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 bigrams used by all presidents") +
  theme(plot.title = element_text(size = 7), 
        axis.title.x = element_text(size = 7), 
        axis.title.y = element_text(size = 7),
        axis.text.x = element_text(size = 7),
        axis.text.y = element_text(size = 7),
        legend.position = '')+
  scale_fill_gradient(low = "black", high = "grey")


# Most common trigram used by all presidents ------------------------------
overall_common_trigram <- sona_sentiment %>% 
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 trigrams used by all presidents") +
  theme(plot.title = element_text(size = 7), 
        axis.title.x = element_text(size = 7), 
        axis.title.y = element_text(size = 7),
        axis.text.x = element_text(size = 7),
        axis.text.y = element_text(size = 7),
        legend.position = '')+
  scale_fill_gradient(low = "black", high = "grey")

```

An overall analysis was executed on the speeches to extract the top 20 words, bigrams and trigrams used by all the presidents to obtain an idea about which of those conveyed meaningful information.

@fig-A represents the top 20 words, bigrams and trigrams used by all presidents. Plot **A** showcases that all presidents would obviously address the public most of the time. Moreover, the top words were linked to development and were very businessy. Plot **B** were way more meaningful than plot **A** and it seemed like majority of presidents were addressing private sectors more than public sectors in their speeches. They addressed the unity of nations, job creations, justice system and specific locations in South Africa. Mandela seemed to have been a model to the other presidents being the first anti-apartheid activist and president of the country, hence mentioned several times. The 2010 FIFA world cup that was held in South Africa brought such a positive and festive vibe in Cape Town, no wonder why it was in the top 20 bigrams. Plot **C** was even more meaningful and we could observe that the bigram "justice system" and "criminal justice" were the least occurred words in the top 20 bigram plot. That was because those particular bigrams were not that meaningful, as such plot **C**

```{r fig-A, message=FALSE, warning=FALSE, results='hide', echo=FALSE, fig.align='center', fig.cap="Top 20 words, pair of words (bigrams), and trio of words (trigrams) used by all presidents.", fig.width = 10}

# combining above plots in one figure
cowplot::plot_grid(overall_common_words, overall_common_bigram, overall_common_trigram,
                   nrow = 1, ncol = 3, labels = "AUTO", label_size = 6, label_x = 0) +
  theme(plot.background = element_rect(color = "black", linewidth = 2))
```

revealed the real meaning of the words being criminal justice system, hence that trigram had the highest occurrence. In addition, a lot of projects like trade union movement, public private partnership, child support grant, adult basic education, continental free trade, community of forum and more were the subject matter amid presidents. The economy of the country was also address in terms of the gross domestic product (GDP), however, problems like gender-based violence outweighed the number of occurrences for the country's GDP, and this priority was valid here.

```{r Top 20 trigrams used by each of the presidents, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# Most common trigram used per president ----------------------------------
common_trigram_Mandela <- sona_sentiment %>% 
  filter(pres == 'Mandela') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 trigrams used by Mandela") +
  theme(plot.title = element_text(size = 11), legend.position = '') +
  scale_fill_gradient(low = "deeppink3", high = "pink")

common_trigram_deKlerk <- sona_sentiment %>% 
  filter(pres == 'deKlerk') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 trigrams used by deKlerk") +
  theme(plot.title = element_text(size = 11), legend.position = '') +
  scale_fill_gradient(low = "chocolate", high = "burlywood1")
  
common_trigram_Mbeki <- sona_sentiment %>% 
  filter(pres == 'Mbeki') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 trigrams used by Mbeki") +
  theme(plot.title = element_text(size = 11), legend.position = '') 

common_trigram_Zuma <- sona_sentiment %>% 
  filter(pres == 'Zuma') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 trigrams used by Zuma") +
  theme(plot.title = element_text(size = 11), legend.position = '') +
  scale_fill_gradient(low = "magenta4", high = "plum") 

common_trigram_Motlanthe <- sona_sentiment %>% 
  filter(pres == 'Motlanthe') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 trigrams used by Motlanthe") +
  theme(plot.title = element_text(size = 11), legend.position = '') +
  scale_fill_gradient(low = "darkcyan", high = "paleturquoise") 

common_trigram_Ramaphosa <- sona_sentiment %>% 
  filter(pres == 'Ramaphosa') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 trigrams used by Ramaphosa") +
  theme(plot.title = element_text(size = 11), legend.position = '') +
  scale_fill_gradient(low = "darkgreen", high = "darkseagreen1")



```

@fig-C displays the top 20 trigrams per president. Mandela's trigrams clearly indicated the challenges and priorities, he was dealing at his time of presidency. Without re-emphasising on the trigrams, here's a brief overiew. Mandela's commitment to address social issues, improving public services, maintaining law and order, promoting workers' rights, and ensuring a strong constitutional framework has not gone unnoticed. Once again, his presidency was characterized by a focus on reconciliation and inclusivity, as well as engagement with international matters. Overall, Mandela's presidency was marked by his dedication to nation-building, social progress, and upholding democratic values. Due to the fact that deKlerk was only a 1-term president, all his top words had only a count of 1. Once again, the word constitution appeared multiple times. Indeed, he was dealing with a period of significant political transformation in South Africa. He was therefore working on constitutional negotiations, peace-building, and addressing political and social challenges. His presidency was marked by efforts to move away from apartheid policies and towards a more inclusive and democratic system. Mbeki's top tier words looked quite diverse. He appeared to address issues related to security, governance, economic development, and education. Moreover, the focus on major sporting events like the soccer world cup suggested a commitment to the country's international standing and promoting sports. Additionally, the reference to traditional leadership and community centres indicated engagement with South Africa's cultural and local governance dynamics. As per the top 20 trigrams for Zuma, he seemed to have focused on economic policies, infrastructure development, and addressing corruption. Apart from the social and economic programs, he had to host the 2010 FIFA world cup during his tenure. Motlanthe's trigrams was not that helpful as he was also only a 1-term president. His top 20 trigrams did not convey meaningful information. The only observation was that it appeared that he may have been dealing with a range of complex challenges, with a focus on social and economic development, justice and anti-corruption. Ramaphosa's trigrams sounded very promising and he seemed to have focused on addressing a wide range of issues, including social challenges like gender-based violence, economic development through trade and job creation, legal and constitutional matters, and engagement with various communities and organizations. His governance reflects a multifaceted approach with policy-making aimed at addressing both immediate and long-term challenges facing South Africa. An observation was made that across the trigrams per president, criminal justice system has appeared various time, which also means that crime is still a persistent problem in South Africa.

```{r fig-C, message=FALSE, warning=FALSE, results='hide', echo=FALSE, fig.align='center', fig.cap="Top 20 trio of words (trigrams) used by each president. **A** relates to Mandela's trigrams, **B** relates to deKlerk's trigrams, **C** relates to Mbeki's trigrams, **D** relates to Zuma's trigrams, **E** relates to Motlanthe's trigrams, and **F** relates to Ramaphosa's trigrams.", fig.width = 10, fig.height = 10}
# combining above plots in one figure
cowplot::plot_grid(common_trigram_Mandela, common_trigram_deKlerk,
                   common_trigram_Mbeki, common_trigram_Zuma,
                   common_trigram_Motlanthe, common_trigram_Ramaphosa,
                   nrow = 3, ncol = 2, labels = "AUTO", label_size = 10, label_x = 0) +
  theme(plot.background = element_rect(color = "black", linewidth = 2))
```

## Sentiment Analysis

```{r Top 20 positive/negative trigrams used by all presidents, message=FALSE, warning=FALSE, results='hide', echo=FALSE}
# Most common positive trigrams used by all presidents --------------------
# redefining bing dictionary and force the word 'anti' to be positive.
bing_word1 <- bing %>%
  mutate(word1 = word) %>% 
  add_row(sentiment = 'positive', word1 = 'anti') %>%
  dplyr::select(-1)
bing_word2 <- bing %>%
  mutate(word2 = word) %>% 
  add_row(sentiment = 'positive', word2 = 'anti') %>%
  dplyr::select(-1)
bing_word3 <- bing %>%
  mutate(word3 = word) %>% 
  add_row(sentiment = 'positive', word3 = 'anti') %>%
  dplyr::select(-1)

overall_common_positive_trigrams <- sona_sentiment %>% 
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'positive') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 positive trigrams used by all presidents") +
  theme(plot.title = element_text(size = 10), legend.position = '')+
  scale_fill_gradient(low = "springgreen", high = "darkseagreen1")



overall_common_negative_trigrams <- sona_sentiment %>% 
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'negative') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 negative trigrams used by all presidents") +
  theme(plot.title = element_text(size = 10), legend.position = '')+
  scale_fill_gradient(low = "red", high = "pink")
```

Plot **A** of @fig-H is a typical example of the presidents trying to improve the well-being of the local population, especially those who live in informal settlements suffering from basic amenities. So, the positive trigrams highlighted a range of policy areas, projects and achievements, including social welfare, economic development, public services, infrastructure, and international engagement.

For plot **B**, there were several words like gross domestic product, crime prevention strategy, sexual offence court, prosecute authority npa, sexual office unit, passenger rail agency, gross fix capital, fight organise crime, emergency task team, corruption task team, and corruption advisory council which should not have been categorised as negative sentiment. Nevertheless, the problem for crime seemed persistent which was why a criminal justice system needed refinement. Although the criminal justice system is a positive sentiment, we treated it as negative because if there were no crimes, it would be pointless to have a criminal justice system. So, its existence entailed the unsolved problem of crime in the country. In fact, the same logic could be argued with regards to sexual offence court.

```{r fig-H, message=FALSE, warning=FALSE, results='hide', echo=FALSE, fig.align='center', fig.cap="Top 20 positive (**A**) and negative (**B**) trio of words (trigrams) used by all presidents.", fig.width = 10}

# combining above plots in one figure
cowplot::plot_grid(overall_common_positive_trigrams, overall_common_negative_trigrams,
                   nrow = 1, ncol = 2, labels = "AUTO", label_size = 10, label_x = 0)+
  theme(plot.background = element_rect(color = "black", linewidth = 2))

```

```{r Top 20 positive trigrams used by each of the presidents, message=FALSE, warning=FALSE, results='hide', echo=FALSE}
# Most common positive trigrams used per president ------------------------
Mandela_common_positive_trigrams <- sona_sentiment %>% 
  filter(pres == 'Mandela') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'positive') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 positive trigrams used by Mandela") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "deeppink3", high = "pink")


deKlerk_common_positive_trigrams <- sona_sentiment %>% 
  filter(pres == 'deKlerk') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'positive') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("The only 9 positive trigrams used by deKlerk") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "chocolate", high = "burlywood1")


Mbeki_common_positive_trigrams <- sona_sentiment %>% 
  filter(pres == 'Mbeki') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'positive') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 positive trigrams used by Mbeki") +
  theme(plot.title = element_text(size = 9), legend.position = '')

Zuma_common_positive_trigrams <- sona_sentiment %>% 
  filter(pres == 'Zuma') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'positive') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 positive trigrams used by Zuma") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "magenta4", high = "plum")

Motlanthe_common_positive_trigrams <- sona_sentiment %>% 
  filter(pres == 'Motlanthe') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'positive') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 positive trigrams used by Motlanthe") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "darkcyan", high = "paleturquoise")



Ramaphosa_common_positive_trigrams <- sona_sentiment %>% 
  filter(pres == 'Ramaphosa') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'positive') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 positive trigrams used by Ramaphosa") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "springgreen", high = "darkseagreen1")



```

@fig-I depicts the positive sentiment of trigrams per president. Mandela's positive sentiment focused on social welfare, economic development, social justice, reconciliation, and peace. He worked to create a more inclusive and just society while addressing a range of challenges, both domestic and international. He wanted to promote black empowerment as he was fighting for the abolition of apartheid. So, Mandela's commitment to building a post-apartheid South Africa that was democratic, equitable, and prosperous is still engraved in our heart. His main priority seemed to be the provision for free medical care. Since deKlerk was only a 1-term president, only 9 unique positive trigrams were obtained. His focus on building trust, finding practical solutions, and ensuring genuine autonomy and constitutional safeguards indicated a commitment to resolving issues related to apartheid, political reform, and peace-building. It was consistent with his role in initiating negotiations to end apartheid and lead South Africa towards a more inclusive and democratic future. The top 20 positive sentiment trigrams for Mbeki was focused on infrastructure and basic amenities development, social welfare, economic growth, and international cooperation (i.e, afro-asian solidarity). He definitely tried to promote unity and solidarity in South Africa. Zuma's positive sentiment trigrams showcased an all-rounded presidency with a focus on social welfare, diplomacy, economic development, public health, and governance. The positive sentiment trigrams from Motlanthe also being a 1-term president aimed to address a range of issues, including economic growth, social welfare, competitiveness, equitable development, and infrastructure improvement. His administration appeared to have focused on creating a more inclusive and socially responsible society, with an emphasis on social support, economic stability, and equitable access to healthcare. It was no surprise to see that continental free trade was the first positive sentiment trigram for Ramaphosa, as he is always very business-oriented. He was really dedicated to economic growth, social inclusivity, diplomacy, democratic governance, and addressing pressing issues such as land reform and healthcare. He seemed to also focus on collaborative efforts and comprehensive planning to address the nation's challenges and drive progress. Overall, it was observed that most presidents were promoting child support grant and free basic amenities and clean water.

```{r fig-I, message=FALSE, warning=FALSE, results='hide', echo=FALSE, fig.align='center', fig.cap="Top 20 positive trio of words (trigrams) used by each president. **A** relates to Mandela's positive trigrams, **B** relates to deKlerk's positive trigrams, **C** relates to Mbeki's positive trigrams, **D** relates to Zuma's positive trigrams, **E** relates to Motlanthe's positive trigrams, and **F** relates to Ramaphosa's positive trigrams.", fig.width = 10, fig.height = 10}
# combining above plots in one figure
cowplot::plot_grid(Mandela_common_positive_trigrams, deKlerk_common_positive_trigrams,
                   Mbeki_common_positive_trigrams, Zuma_common_positive_trigrams,
                   Motlanthe_common_positive_trigrams, Ramaphosa_common_positive_trigrams,
                   nrow = 3, ncol = 2, labels = "AUTO", label_size = 10, label_x = 0)+
  theme(plot.background = element_rect(color = "black", linewidth = 2))
```

```{r Top 20 negative trigrams used by each of the presidents, message=FALSE, warning=FALSE, results='hide', echo=FALSE}
# Most common negative trigrams used per president ------------------------

Mandela_common_negative_trigrams <- sona_sentiment %>% 
  filter(pres == 'Mandela') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'negative') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 negative trigrams used by Mandela") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "deeppink3", high = "pink")


deKlerk_common_negative_trigrams <- sona_sentiment %>% 
  filter(pres == 'deKlerk') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'negative') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("The only 5 negative trigrams used by deKlerk") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "chocolate", high = "burlywood1")


Mbeki_common_negative_trigrams <- sona_sentiment %>% 
  filter(pres == 'Mbeki') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'negative') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 negative trigrams used by Mbeki") +
  theme(plot.title = element_text(size = 9), legend.position = '')

Zuma_common_negative_trigrams <- sona_sentiment %>% 
  filter(pres == 'Zuma') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'negative') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 negative trigrams used by Zuma") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "magenta4", high = "plum")


Motlanthe_common_negative_trigrams <- sona_sentiment %>% 
  filter(pres == 'Motlanthe') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'negative') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("The only 18 negative trigrams used by Motlanthe") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "darkcyan", high = "paleturquoise")


Ramaphosa_common_negative_trigrams <- sona_sentiment %>% 
  filter(pres == 'Ramaphosa') %>%
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  filter(bing_sentiment == 'negative') %>%
  count(trigram, sort = T) %>%
  slice(1:20) %>%
  #filter(rank(desc(n)) <= 20) %>%
  ggplot(aes(x = reorder(trigram, n), y = n, fill = -n)) + geom_col() + coord_flip() + ylab('Count') + xlab('') +
  ggtitle("Top 20 negative trigrams used by Ramaphosa") +
  theme(plot.title = element_text(size = 9), legend.position = '') +
  scale_fill_gradient(low = "springgreen", high = "darkseagreen1")
```

@fig-J illustrates the negative sentiment of trigrams per president. Mandela's presidency emphasised on inclusivity, human rights and social justice as mentioned before. During his time, he unfortunately had to deal with significant challenges, such as crime, corruption, land issues, child abuse and rape, poverty, and environmental concerns. The top 2 sentiments were rather positive, but crime related. Due to deKlerk being a 1-term president, he had only 5 unique negative sentiments trigrams which did not really convey much information apart from words like hopeless, hard negotiation, threaten, conflict and difficulty which only highlighted some challenges and hardships during his presidency without any specific context. Ignoring the trigrams which were supposed to have strictly positive sentiments like gross domestic product and post conflict reconstruction; the crime related matter kept on persisting with some other social matters, public health issues and other political challenges. Again, ignoring gross domestic product being a positive sentiment trigram, the crime issue were on top of the list during Zuma's presidency. Furthermore, he had to deal with corruption, economic challenges, infrastructural breakdown, and some social and environmental concerns. Motlanthe's was also a 1-term president and from the trigrams, "poverty decline substantially", "metric poverty decline", "input price decline", "hungry decline dramatically", "gross fix capital" and "gross domestic product" should be ignored and treated as positive sentiment. This was a good example of the disadvantages of using lexicon-dictionary based approach for sentiment analysis. Nevertheless, crime, inequality, security measure issue, economic issues, political challenges and illicit activities were still the major concerns during his presidency. We again see some false negative sentiment present in the trigrams for Ramaphosa. Ignoring those, he still had to deal with crime related issues, violence in public, poverty, insanitation, water shortage, drug trafficking, debt perhaps due to the global pandemic which he also mentioned. It was quite clear that throughout all these year the crime issues, poverty, and violence were not able to eradicate or at a bare minimum to mitigate.

```{r fig-J, message=FALSE, warning=FALSE, results='hide', echo=FALSE, fig.align='center', fig.cap="Top 20 negative trio of words (trigrams) used by each president. **A** relates to Mandela's negative trigrams, **B** relates to deKlerk's negative trigrams, **C** relates to Mbeki's negative trigrams, **D** relates to Zuma's negative trigrams, **E** relates to Motlanthe's negative trigrams, and **F** relates to Ramaphosa's negative trigrams.", fig.width = 10, fig.height = 10}
# combining above plots in one figure
cowplot::plot_grid(Mandela_common_negative_trigrams, deKlerk_common_negative_trigrams,
                   Mbeki_common_negative_trigrams, Zuma_common_negative_trigrams,
                   Motlanthe_common_negative_trigrams, Ramaphosa_common_negative_trigrams,
                   nrow = 3, ncol = 2, labels = "AUTO", label_size = 10, label_x = 0)+
  theme(plot.background = element_rect(color = "black", linewidth = 2))
```

```{r positive and negative trigrams sentiment over time, message=FALSE, warning=FALSE, results='hide', echo=FALSE}
# Overall change in trigram sentiment over time ---------------------------

overall_trigram_bing_sentiment_change_over_time <- sona_sentiment %>% 
  filter(!pres %in% c('deKlerk', 'Motlanthe')) %>% # excluding 1 time president
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  group_by(bing_sentiment, speech_year) %>%
  tally() %>%
  pivot_wider(names_from = 'bing_sentiment', values_from = n, values_fill = 0) %>%
  mutate(bing_sentiment_pos_minus_neg = positive - negative) %>%
  ggplot(aes(x = speech_year, y = bing_sentiment_pos_minus_neg)) + 
  geom_col(fill = 'springgreen') + 
  geom_col(data=. %>% filter(bing_sentiment_pos_minus_neg<0), fill = 'red') +
  xlab('Year') + ylab('Sentiment') +
  theme(plot.title = element_text(size = 11)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_rect(aes(xmin = 1 - 0.5, xmax = 6 + 0.5, ymin = 0, ymax = 16),
            fill = "transparent", color = "deeppink3", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=1.15, y= 3+16, label="Mandela",color="deeppink3", size = 3) +
  geom_rect(aes(xmin = 7 - 0.5, xmax = 15 + 0.5, ymin = -12, ymax = 25),
            fill = "transparent", color = "steelblue", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=7, y= 3+25, label="Mbeki",color="steelblue", size = 3) +
  geom_rect(aes(xmin = 16 - 0.5, xmax = 24 + 0.5, ymin = 0, ymax = 40),
            fill = "transparent", color = "magenta4", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=16, y=3+40, label="Zuma",color="magenta4", size = 3) +
  geom_rect(aes(xmin = 25 - 0.5, xmax = 30 + 0.5, ymin = 0, ymax = 85),
            fill = "transparent", color = "darkgreen", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=25+.3, y=3+85, label="Ramaphosa",color="darkgreen", size = 3) 


overall_pos_neg_trigram_fluctuation <- sona_sentiment %>% 
  filter(!pres %in% c('deKlerk', 'Motlanthe')) %>% # excluding 1 time president
  unnest_tokens(trigram, speech, token = 'ngrams', n=3) %>%
  separate(trigram, c('word1', 'word2', 'word3'), sep = ' ') %>%
  filter(str_detect(word1, '[a-z]'), str_detect(word2, '[a-z]'), str_detect(word3, '[a-z]')) %>%
  filter(!word1 %in% stop_words$word & !word2 %in% stop_words$word & !word3 %in% stop_words$word) %>%
  left_join(bing_word1, by = 'word1') %>% rename(bing_sentiment1 = sentiment) %>%
  left_join(bing_word2, by = 'word2') %>% rename(bing_sentiment2 = sentiment) %>%
  left_join(bing_word3, by = 'word3') %>% rename(bing_sentiment3 = sentiment) %>%
  filter(!grepl(common_sona_reg, word1)) %>%
  filter(!grepl(common_sona_reg, word2)) %>%
  filter(!grepl(common_sona_reg, word3)) %>%
  unite(trigram, word1, word2, word3, sep = ' ') %>%
  mutate(bing_sentiment1 = ifelse(is.na(bing_sentiment1), 'neutral', bing_sentiment1)) %>%
  mutate(bing_sentiment2 = ifelse(is.na(bing_sentiment2), 'neutral', bing_sentiment2)) %>%
  mutate(bing_sentiment3 = ifelse(is.na(bing_sentiment3), 'neutral', bing_sentiment3)) %>%
  mutate(bing_sentiment1_score = case_when(bing_sentiment1 == 'neutral' ~ 0,
                                           bing_sentiment1 == 'positive' ~ 1,
                                           bing_sentiment1 == 'negative' ~ -1),
         bing_sentiment2_score = case_when(bing_sentiment2 == 'neutral' ~ 0,
                                           bing_sentiment2 == 'positive' ~ 1,
                                           bing_sentiment2 == 'negative' ~ -1),
         bing_sentiment3_score = case_when(bing_sentiment3 == 'neutral' ~ 0,
                                           bing_sentiment3 == 'positive' ~ 1,
                                           bing_sentiment3 == 'negative' ~ -1),
         bing_sentiment_finalscore = bing_sentiment1_score +bing_sentiment2_score+bing_sentiment3_score,
         bing_sentiment = case_when(bing_sentiment_finalscore == 0 ~ 'neutral',
                                    bing_sentiment_finalscore >= 1 ~ 'positive',
                                    bing_sentiment_finalscore <  1 ~ 'negative')) %>%
  group_by(bing_sentiment, speech_year) %>%
  tally() %>%
  filter(bing_sentiment != 'neutral') %>%
  ggplot(aes(x = speech_year, y = n, colour = bing_sentiment, group = bing_sentiment)) + 
  geom_line() +
  scale_colour_manual(values = c("positive" = "springgreen", "negative" = "red")) +
  geom_smooth(linewidth = 0.2, alpha = 0.2, level = 0.6) +
  ylab('Count') +
  xlab('Year') +
  theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position = 'bottom') +
  labs(color = '') +
  geom_rect(aes(xmin = 1 , xmax = 6 , ymin = 0, ymax = 55),
            fill = "transparent", color = "deeppink3", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=1+.5, y=7+55, label="Mandela",color="deeppink3", size = 3) +
  geom_rect(aes(xmin = 7 , xmax = 15 , ymin = 0, ymax = 55),
            fill = "transparent", color = "steelblue", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=7+.5, y=7+55, label="Mbeki",color="steelblue", size = 3) +
  geom_rect(aes(xmin = 16, xmax = 24, ymin = 0, ymax = 75),
            fill = "transparent", color = "magenta4", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=16+.5, y=7+75, label="Zuma",color="magenta4", size = 3) +
  geom_rect(aes(xmin = 25, xmax = 30, ymin = 0, ymax = 150),
            fill = "transparent", color = "darkgreen", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=25+.8, y=7+150, label="Ramaphosa",color="darkgreen", size = 3) 

```

So, when we investigated the sentiment over the years from @fig-K, we noticed that plot **A** had always more positive than negative sentiment and has increased over the years. Except that during Mbeki's presidency in 2001, the negative sentiment for the trigrams surpassed the positive ones, perhaps because of the rise in HIV/AIDS in South Africa. Plot **B** shows the fluctuation in count of positive and negative sentiment throughout the years. It is worth noting that the positive sentiments were larger than the negative sentiments. Consider the positive sentiment, the fluctuations occurrences indicates the positive sentiment count in the previous year tend to be higher than the following year relative to the previous year. This means that the presidents were hopeful for country to implement the project as planned, however, in the following year they always have to deal with some societal or economic challenges which caused the drop in the positive sentiment. This observation was supported in @miranda2021exploring as well, meaning that in general that tends to be the case. Another interesting observation was that whenever there was a peak in negative sentiment, logically we would guess a drop in positive sentiment below the negative sentiment (i.e, more negative sentiment than positive sentiment). However, whenever the negative sentiment was very high, the positive sentiment also increased. That means whenever there's something bad happening, the politicians tend to cover it up with good or positive speeched to decrease tension and mask the actuality. Moreoverm the trends between the positive and negative sentiment had increased over the years and the sudden drop in positive and negative sentiment in 2020 was due to the global pandemic covid-19. So, as a final observation, it seemed as if over the years the South African presidents were improved and did better with an increasing trend in positive sentiment.

```{r fig-K, message=FALSE, warning=FALSE, results='hide', echo=FALSE, fig.align='center', fig.cap=" Positive and negative trio of words (trigrams) sentiment over time (excluding 1-term presidents such as deKlerk and Motlanthe). **A** corresponds to how many more positive than negative trigrams (or vice versa) computed over the years [1994-2023]. So, the y-axis for **A** was calculated as *Sentiment = positive trigrams - negative trigrams*. **B** refers to the actual count of positive and negative trigrams throughout the same mentioned period. The bounding boxes indicate which part of this timeline belongs to the presidency period of Mandela, Mbeki, Zuma and Ramaphosa.", fig.width = 10, fig.height = 7}
# combining above plots in one figure
cowplot::plot_grid(overall_trigram_bing_sentiment_change_over_time, overall_pos_neg_trigram_fluctuation,
                   nrow = 2, ncol = 1, labels = "AUTO", label_size = 10, label_x = 0)

```

```{r fig-R, echo=FALSE, eval=TRUE,warning=FALSE,fig.align='center',message=FALSE,fig.cap="Evolution of emotions expressed over time from 1994-2023 by all presidents.", fig.width = 10, fig.height = 6}
# removing deKlerk and Motlanthe from the analysis as they made only 1 speech
nrc_sona_tdf  <- nrc_sona_tdf  %>%
  filter(!pres %in% c('deKlerk', 'Motlanthe')) # excluding 1 time president

#nrc over time 
emotion_change_over_time <- nrc_sona_tdf %>%
  left_join(nrc, by = "word") %>%
  mutate(sentiment = ifelse(is.na(sentiment), 'neutral', sentiment)) %>%
  filter(sentiment != "neutral")%>%
  group_by(sentiment,speech_year) %>%
  summarize(n = n()) 

emotion_change_over_time <-emotion_change_over_time%>%
  left_join(emotion_change_over_time %>% 
              group_by(speech_year) %>% 
              summarise(total = sum(n))) %>%
  mutate(freq = n/total)

emotion_change_over_time %>%
  ggplot(aes(x = speech_year, y = freq, colour = sentiment,group=sentiment)) +
  geom_line() +
  geom_smooth(aes(colour = sentiment)) + ylab("Frequency") + xlab("Year")+
  ggtitle("Emotion Change Over Time") +
  theme(plot.title = element_text(size = 11), legend.position = 'bottom')+ 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(color = '') +
  geom_rect(aes(xmin = 1 , xmax = 6 , ymin = 0, ymax = 0.3),
            fill = "transparent", color = "deeppink3", size = .05 , linetype = '8f') + ggplot2::annotate(geom="text", x=1+.5, y=0.31, label="Mandela",color="deeppink3", size = 3) +
  geom_rect(aes(xmin = 7 , xmax = 15 , ymin = 0, ymax = 0.3),
            fill = "transparent", color = "steelblue", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=7+.5, y=0.31, label="Mbeki",color="steelblue", size = 3) +
  geom_rect(aes(xmin = 16, xmax = 24, ymin = 0, ymax = 0.3),
            fill = "transparent", color = "magenta4", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=16+.5, y=0.31, label="Zuma",color="magenta4", size = 3) +
  geom_rect(aes(xmin = 25, xmax = 30, ymin = 0, ymax =0.3),
            fill = "transparent", color = "darkgreen", size = .05, linetype = '8f') + ggplot2::annotate(geom="text", x=25+.8, y=0.31, label="Ramaphosa",color="darkgreen", size = 3)
 
```

In @fig-R, we observe the evolution of emotional dynamics over time. Notably, there is a distinct upswing in the expression of positive emotions, particularly from 2009 when President Zuma assumed office. This trend potentially signifies President Zuma's leadership style, which may have prioritized positivity, unity, and motivation. Alternatively, it could imply that his speeches served as a means of crisis management, offering reassurance to the public and reinforcing the notion of stability and control during challenging times. We can observe a significant increase in negative emotions during the time frame spanning 2021 to 2023, marked notably by heightened expressions of fear and sadness. This trend can be traced back to the profound global impact of the novel coronavirus, which affected nations worldwide in 2020.

## Topic Modelling

```{r lda_graph1, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# Visualize top terms per topic using ggplot
sona_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term, fill = factor(topic))) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free") +
  labs(title = "Figure 1 : Top terms per LDA-generated topic - All Presidential Speeches") +
  scale_y_reordered()

```

```{r lda_doc, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# Examine the per-president-per-topic probabilities, γ (“gamma”), 
# with the matrix = "gamma" argument to tidy()
sona_documents <- tidy(sona_lda, matrix = "gamma")

# Determine which president has the highest gamma score per topic
sona_document_prob <- sona_documents %>%
  group_by(topic) %>%
  slice_max(order_by = round(gamma, 3), n = 1) %>%
  ungroup() %>% 
  mutate(gamma = round(gamma, 3))

colnames(sona_document_prob) <- c("President", "Topic", "Gamma")

# Summarise the topic gamma values, and example words per topic
topic_names <- c("Topic 1", "Topic 2", "Topic 3", "Topic 4", "Topic 5")
topic_presidents <- c("deKlerk", "Mandela", "Mbeki", "Ramaphosa", "Zuma")
topic_words <- c("constitution, change, improve, parliament, create", "nation, build, human, crime, job, address", "system, world, growth, poverty, challenge", "business, investment, build, growth, improve", "compratriot, water, education, community, plan")

sona_topic_summary <- cbind(topic_names, topic_presidents, topic_words)
colnames(sona_topic_summary) <- c("Topic", "President", "Example Words")

```

```{r topic.prob, echo=FALSE}
#| label: tbl-probs
#| tbl-cap: "President-Per-Topic Probabilities"
#| tbl-colwidths: [60,20,20]

# display the president per-topic probabilities
kable(sona_document_prob)
```

From the LDA topic modelling on all speeches, there is a clear probabilistic relationship between top 5 topics and which president each topic relates to.

```{r topic.summary, echo=FALSE}
#| label: tbl-topic-summary
#| tbl-cap: "Topic Summaries"
#| tbl-colwidths: [20,20, 60]

kable(sona_topic_summary)
```

The comparison of the log ratio of beta values of different president topics revealed interesting insights into the eras characterizing their tenures, their priorities and the challenges each faced.

```{r lda_beta1, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# beta comparison of topic 1 and topic 2
beta_wide <- sona_topics %>%
  mutate(topic = paste0("topic", topic)) %>%
  pivot_wider(names_from = topic, values_from = beta) %>% 
  filter(topic1 > .001 | topic2 > .001) %>%
  mutate(log_ratio = log2(topic2 / topic1))

# beta comparison of topic 3 and topic 4
beta_wide2 <- sona_topics %>%
  mutate(topic = paste0("topic", topic)) %>%
  pivot_wider(names_from = topic, values_from = beta) %>% 
  filter(topic3 > .001 | topic4 > .001) %>%
  mutate(log_ratio = log2(topic4 / topic3))

# beta comparison of topic 4 and topic 5
beta_wide3 <- sona_topics %>%
  mutate(topic = paste0("topic", topic)) %>%
  pivot_wider(names_from = topic, values_from = beta) %>% 
  filter(topic4 > .001 | topic5 > .001) %>%
  mutate(log_ratio = log2(topic5 / topic4))

par(mfrow=c(2,2))

# Visualize first beta
beta_wide %>%
  group_by(direction = log_ratio > 0) %>%
  top_n(8, abs(log_ratio)) %>%
  ungroup() %>%
  mutate(term = reorder(term, log_ratio)) %>%
  ggplot(aes(term, log_ratio, fill = "#478ACA")) +
  theme(legend.position = "none") +
  geom_col() +
  labs(title = 'Figure 2: Log2 ratio of beta in topic 2 (Mandela) / topic 1 (deKlerk)', y = 'Log ratio difference', x = 'Term') +
  coord_flip()

```

The difference in beta (per-topic-word probabilities) between **Mandela** and **deKlerk** are displayed in *Figure 2*.

deKlerk made a single speech just before the 1994 democratic elections, expressing hope and optimism for a cohesive and cooperative future between all South Africans. Mandela, by contrast, presided over South Africa for the first 5 years of its nascent democracy, and had to grapple and confront many of the social and economic challenges that it presented.

The log ratios between both presidents' topic beta's is very low compared to other subsequent beta comparisons, however, suggesting much commonality in the topics they spoke about and perhaps also their writing styles.

```{r lda_beta2, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# Visualize the second beta
beta_wide2 %>%
  group_by(direction = log_ratio > 0) %>%
  top_n(8, abs(log_ratio)) %>%
  ungroup() %>%
  mutate(term = reorder(term, log_ratio)) %>%
  ggplot(aes(term, log_ratio, fill = "#478ACA")) +
  theme(legend.position = "none") +
  geom_col() +
  labs(title = 'Figure 3: Log2 ratio of beta topic 3 (Mbeki) / topic 4 (Ramaphosa', y = 'Log ratio difference', x = 'Term') +
  coord_flip()

```

A comparison of the words with greatest differences between **Mbeki** and **Ramaphosa** reveal how they dealt with very different agendas during their respective tenures.

Mbeki presided over the hosting of the 2010 FIFA World Cup (`soccer`, `cup`) whilst Ramaphosa had to deal with a global pandemic in 2020-2021 (`covid`, `pandemic`, `restore`) as well as the Eskom electricity crisis which had started already during Mbeki's presidency (`shed`, `SOEs`, `restore`).

On a side note, Mbeki appeared to be very fond of the phrase `"discharge their responsibilities"` which is why the word `discharge` stands out in the comparison.

```{r lda_beta3, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# Visualize the third beta
beta_wide3 %>%
  group_by(direction = log_ratio > 0) %>%
  top_n(8, abs(log_ratio)) %>%
  ungroup() %>%
  mutate(term = reorder(term, log_ratio)) %>%
  ggplot(aes(term, log_ratio, fill = "#478ACA")) +
  theme(legend.position = "none") +
  geom_col() +
  labs(title = 'Figure 4: Log2 ratio of beta topic 4 (Ramaphosa) / topic 5 (Zuma', y = 'Log ratio difference', x = 'Term') +
  coord_flip()

```

A comparison of the words with greatest differences between **Ramaphosa** and **Zuma** reveal differences in their presidential styles.

Terms like `friend` and `compatriot` by Zuma's indicate his reliance on left-wing populist rhetoric in his speeches, whilst the use of terms like `SOEs` and `capture` by Ramaphosa suggest that Zuma did not to any same degree confront the issues of corruption and inefficiencies in state-owned-enterprises (including Eskom) that beset the legacy of his presidency (and which formed the basis of Ramaphosa's subsequent challenges).

```{r lda_beta4, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

ramaphosa_sona <- sona %>% filter(pres == "Ramaphosa")

# turn into tidy text 
tidy_ramaphosa_sona <- ramaphosa_sona %>% 
  mutate(speech = str_replace_all(speech, replace_reg, '')) %>%
  unnest_tokens(word, speech, token = 'regex', pattern = unnest_reg) %>%
  filter(!word %in% stop_words$word, str_detect(word, '[A-Za-z]')) %>%
  dplyr::select(word, pres, date, filename) 

ramaphosa_sona_tdf <- tidy_ramaphosa_sona %>%
  group_by(filename,word) %>%
  count() %>%  
  ungroup()

# Remove common SONA words that are used very regularly, but which don't convey too much meaning
common_sona_reg <- 'wanna|madam|percent|speaker|madame|honourable|chairperson|development|national|ensure|deputy|africa|african|africans|south|southern|government|people|programme|economic|economy|country'
ramaphosa_sona_tdf <- ramaphosa_sona_tdf %>% filter(!grepl(common_sona_reg, word))

dtm_ramaphosa_sona <- ramaphosa_sona_tdf %>% cast_dtm(filename, word, n)

# Estimate the parameters of the topic model using LDA
ramaphosa_sona_lda <- LDA(dtm_ramaphosa_sona, k = 4, control = list(seed = 2023))

# Use the tidy() function by the  tidytext package 
# for extracting the per-topic-per-word probabilities, called β (“beta”), from the model
ramaphosa_sona_topics <- tidy(ramaphosa_sona_lda, matrix = "beta")

ramaphosa_sona_top_terms <- ramaphosa_sona_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 20) %>% 
  ungroup() %>%
  arrange(topic, -beta)

# Visualize using ggplot
#ramaphosa_sona_top_terms %>%
#  mutate(term = reorder_within(term, beta, topic)) %>%
#  ggplot(aes(beta, term, fill = factor(topic))) +
#  geom_col(show.legend = FALSE) +
#  facet_wrap(~ topic, scales = "free") +
#  labs(title = "Figure 5 : Top terms per LDA-generated topic - Ramaphosa Speeches") +
#  scale_y_reordered()
```

```{r lda_beta5, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

ramaphosa_sona_documents <- tidy(ramaphosa_sona_lda, matrix = "gamma")

# Determine which president has the highest gamma score per topic
ramaphosa_sona_documents %>%
  group_by(topic) %>%
  slice_max(order_by = gamma, n = 1) %>%
  ungroup()

ramaphosa_sona_documents <- ramaphosa_sona_documents %>% filter(gamma > 0.9) %>% mutate(gamma = round(gamma, 3))

```

```{r ram.prob, echo=FALSE}
#| label: tbl-ram-probs
#| tbl-cap: "Ramaphosa-Per-Topic Probabilities"
#| tbl-colwidths: [60,20,20]

# display the president per-topic probabilities
# kable(ramaphosa_sona_documents)
```

```{r lda_beta6, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

ramaphosa_beta_wide <- ramaphosa_sona_topics %>%
  mutate(topic = paste0("topic", topic)) %>%
  pivot_wider(names_from = topic, values_from = beta) %>% 
  filter(topic4 > .001 | topic3 > .001) %>%
  mutate(log_ratio = log2(topic3 / topic4))

# Visualize
ramaphosa_beta_wide %>%
  group_by(direction = log_ratio > 0) %>%
  top_n(10, abs(log_ratio)) %>%
  ungroup() %>%
  mutate(term = reorder(term, log_ratio)) %>%
  ggplot(aes(term, log_ratio, fill = "#478aca")) +
  theme(legend.position = "none") +
  geom_col() +
  labs(title = 'Figure 5: Log2 ratio of beta in 2019 post-election speech / 2023 speech', y = 'Log ratio difference', x = 'Term') +
  coord_flip()

```

The section of topic modelling is ended with a look at the greatest word differences between Ramaphosa's **2019 post-election speech**, and the one he delivered in **2023**.

Terms in 2019 included `dream`, `comfort`, `bold` and `NDP` (the *National Development Plan*, initiated in 2013, which aims to eliminate poverty and reduce inequality by 2030).

Terms in the 2023 included `pandemic`, `disaster`, `overcome`, `transition`, and tellingly, not a single mention of the *National Development Plan*.

This suggests the use of optimistic and idealistic terms during an election year that support a political agenda, that is not evident in non-election years.



# Conclusions

# References
